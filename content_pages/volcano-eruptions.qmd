---
title: |
  Volcano Eruptions
description: |
  Static map with `ggplot2`, Interactive map with `leaflet`, Animated map with `gganimate`
date: 2020-05-11
date-format: long
---

Notable topics: Static map with `ggplot2`, Interactive map with `leaflet`, Animated map with `gganimate`

Recorded on: 2020-05-11

Timestamps by: Eric Fletcher

[View code](https://github.com/dgrtwo/data-screencasts/blob/master/volcano-eruptions.Rmd)

## Full screencast

<iframe class="video" src="https://www.youtube.com/embed/pZINGjQ86Hc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Timestamps

<script id="timestamps" type="application-json">[{"timestamp_with_hours":"0:7:00","description":"Change the `last_eruption_year` into `years_ago` by using `mutate` from the `dplyr` package with `years_ago = 2020 - as.numeric(last_eruption_year))`. In the plot David includes `+1` to account for 0 values in the `years_ago` variable.","functions":"mutate","packages":"dplyr","timestamp_sec":420},{"timestamp_with_hours":"0:9:50","description":"Use `str_detect` from the `stringr` package to search the `volcano_name` variable for `Vesuvius` when not sure if spelling is correct.","functions":"str_detect","packages":"stringr","timestamp_sec":590},{"timestamp_with_hours":"0:12:50","description":"Use the `longitude` and `latitude` to create a world map showing where the volcanoes are located.","functions":"grom_point | theme_map | borders","packages":"ggplot2 | ggthemes","timestamp_sec":770},{"timestamp_with_hours":"0:15:30","description":"Use `fct_lump` from the`forcats` package to lump together all `primary_volcano_type` factor levels except for the `n` most frequent.","functions":"fct_lump","packages":"forcats","timestamp_sec":930},{"timestamp_with_hours":"0:16:25","description":"Use `str_remove` from the `stringr` package with the regular expression `\"\\\\(.\\\\)\"` to remove the parentheses.","functions":"str_remove","packages":"stringr","timestamp_sec":985},{"timestamp_with_hours":"0:18:30","description":"Use the `leaflet` package to create an interactive map with popup information about each volcano.","functions":"leaflet | addTiles | addCircleMarkers","packages":"leaflet","timestamp_sec":1110},{"timestamp_with_hours":"0:24:10","description":"Use `glue` from the `glue` package to create an `HTML` string by concatenating `volcano_name` and `primary_volcano_type` between `HTML <p><\/p> tags`.","functions":"glue","packages":"glue","timestamp_sec":1450},{"timestamp_with_hours":"0:27:15","description":"Use the `DT` package to turn the `leaflet` popup information into a `datatable`.","functions":"gather | nest | map","packages":"DT","timestamp_sec":1635},{"timestamp_with_hours":"0:31:40","description":"Use `str_replace_all` fromt he `stringr` package to replace all the underscores `_` in `volcano_name` with space. Then use `str_to_title` from the `stringr` package to convert the `volcano_name` variable to title case.","functions":"str_replace | str_to_title","packages":"stringr","timestamp_sec":1900},{"timestamp_with_hours":"0:32:05","description":"Use `kable` with `format = HTML`  from the `knitr` package instead of `DT` to make turning the data into `HTML` much easier.","functions":"kable","packages":"knitr","timestamp_sec":1925},{"timestamp_with_hours":"0:34:05","description":"Use `paste0` from `base` R to bold the `Volcano Name`, `Primary Volcano Type`, and `Last Eruption Year` in the `leaflet` popup.","functions":"paste0","packages":"base","timestamp_sec":2045},{"timestamp_with_hours":"0:34:50","description":"Use `replace_na` from the `tidyr` package to replace `unknown` with `NA`.","functions":"replace_na","packages":"tidyr","timestamp_sec":2090},{"timestamp_with_hours":"0:37:15","description":"Use `addMeasure` from the `leaflet` package to add a tool to the map that allows for the measuring of distance between points.","functions":"addMeasure","packages":"leaflet","timestamp_sec":2235},{"timestamp_with_hours":"0:39:30","description":"Use `colorNumeric` from the `leaflet` package to color the points based on their `population within 5km`. To accomplish this, David creates 2 new variables: 1) `transformed_pop` to get the population on a `log2` scale & 2) `pop_color` which uses the `colorNumeric` function to generate the color hex values based on `transformed_pop`.","functions":"colorNumeric","packages":"leaflet","timestamp_sec":2370},{"timestamp_with_hours":"0:46:30","description":"Use the `gganimate` package to create an animated map.","functions":"transition_time | frame_time","packages":"gganimate","timestamp_sec":2790},{"timestamp_with_hours":"0:48:45","description":"Use `geom_point` from the `ggplot2` package with `size = .00001 * 10 ^ vei` so the size of the points are then proportional to the `volume` metrics provided in the `Volcano Eruption Index`. The metrics are in `Km^3`.","functions":"geom_point","packages":"ggplot2","timestamp_sec":2925},{"timestamp_with_hours":"0:50:20","description":"Use `scale_size_continuous` from the `ggplot2` package with `range = c(.1, 6)` to make the smaller points smaller and larger points larger.","functions":"scale_size_continuous","packages":"ggplot2","timestamp_sec":3020},{"timestamp_with_hours":"0:50:55","description":"Use `scale_color_gradient2` from the `ggplot2` package to apply color gradient to each point based on the volcano size and whether its low or high.","functions":"scale_color_gradient2","packages":"ggplot2","timestamp_sec":3055},{"timestamp_with_hours":"0:59:40","description":"Summary of screencast while waiting for `gganimate` map to render. \n\nAlso, brief discussion on using `transition_reveal` instead of `transition_time` to keep the point on the map instead of replacing them in each frame.","functions":"transition_reveal","packages":"gganimate","timestamp_sec":3580}]</script>
