---
title: |
  US Dairy Consumption
description: |
  Time series analysis, Forecasting (sweep package)
date: 2019-01-28
date-format: long
---

Notable topics: Time series analysis, Forecasting (sweep package)

Recorded on: 2019-01-28

Timestamps by: Alex Cookson

[View code](https://github.com/dgrtwo/data-screencasts/blob/master/us-dairy.Rmd)

## Full screencast

<iframe class="video" src="https://www.youtube.com/embed/13iG_HkEPVc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Timestamps

<script id="timestamps" type="application-json">[{"timestamp_with_hours":"0:2:50","description":"Identifying the need for a gather step","timestamp_sec":170},{"timestamp_with_hours":"0:4:40","description":"Changing snake case to title case using str_to_title and str_replace_all functions","functions":"str_to_title | str_replace_all","timestamp_sec":280},{"timestamp_with_hours":"0:6:20","description":"Identifying need for separating categories into major and minor categories (e.g., \"Cheese Other\" can be divided into \"Cheese\" and \"Other\")","timestamp_sec":380},{"timestamp_with_hours":"0:7:10","description":"Using separate function to split categories into major and minor categories (good explanation of \"extra\" argument, which merges additional separations into one field)","functions":"separate","timestamp_sec":430},{"timestamp_with_hours":"0:8:20","description":"Using coalesce function to deal with NAs resulting from above step","functions":"coalesce","timestamp_sec":500},{"timestamp_with_hours":"0:10:30","description":"Dealing with graph of minor category that is linked to multiple major categories (\"Other\" linked to \"Cheese\" and \"Frozen\")","timestamp_sec":630},{"timestamp_with_hours":"0:13:10","description":"Introducing fct_lump function as an approach to work with many categories","functions":"fct_lump","timestamp_sec":790},{"timestamp_with_hours":"0:14:50","description":"Introducing facetting (facet_wrap function) as second alternative to working with many categories","functions":"facet_wrap","timestamp_sec":890},{"timestamp_with_hours":"0:15:50","description":"Dealing with \"Other\" category having two parts to it by using ifelse function in the cleaning step (e.g., go from \"Other\" to \"Other Cheese\")","timestamp_sec":950},{"timestamp_with_hours":"0:19:45","description":"Looking at page for the sweep package","packages":"sweep","timestamp_sec":1185},{"timestamp_with_hours":"0:21:20","description":"Using tk_ts function to coerce a tibble to a timeseries","functions":"tk_ts","packages":"sweep","timestamp_sec":1280},{"timestamp_with_hours":"0:22:10","description":"Turning year column (numeric) into a date by adding number of years to Jan 1, 0001","timestamp_sec":1330},{"timestamp_with_hours":"0:26:00","description":"Nesting time series object into each combination of category and product","timestamp_sec":1560},{"timestamp_with_hours":"0:27:50","description":"Applying ETS (Error, Trend, Seasonal) model to each time series","timestamp_sec":1670},{"timestamp_with_hours":"0:28:10","description":"Using sw_glance function (sweep package's version of glance function) to pull out model parameters from model field created in above step","functions":"sw_glance","packages":"sweep","timestamp_sec":1690},{"timestamp_with_hours":"0:29:45","description":"Using sw_augment function to append fitted values and residuals from the model to the original data","functions":"sw_augment","timestamp_sec":1785},{"timestamp_with_hours":"0:30:50","description":"Visualising actual and fitted values on the same graph to get a look at the ETS model","timestamp_sec":1850},{"timestamp_with_hours":"0:32:10","description":"Using Arima function (note the capital A) as alternative to ETS (not sure what difference is between arima and Arima)","functions":"Arima","timestamp_sec":1930},{"timestamp_with_hours":"0:35:00","description":"Forecasting into the future using an ETS model using various functions: unnest, sw_sweep, forecast","functions":"sw_sweep | forecast","packages":"sweep","timestamp_sec":2100},{"timestamp_with_hours":"0:37:45","description":"Using geom_ribbon function to add confidence bounds to forecast","functions":"geom_ribbon","timestamp_sec":2265},{"timestamp_with_hours":"0:40:20","description":"Forecasting using auto-ARIMA (instead of ETS)","timestamp_sec":2420},{"timestamp_with_hours":"0:40:55","description":"Applying two forecasting methods at the same time (auto-ARIMA and ETS) using the crossing function","functions":"crossing","timestamp_sec":2455},{"timestamp_with_hours":"0:41:55","description":"Quick test of how invoke function works (used to call a function easily, e.g., when it is a character string instead of called directly)","functions":"invoke","timestamp_sec":2515},{"timestamp_with_hours":"0:47:35","description":"Removing only one part of legend (line type of solid or dashed) using scale_linetype_discrete function","functions":"scale_linetype_discrete","timestamp_sec":2855},{"timestamp_with_hours":"0:51:25","description":"Using gather function to clean up new dataset","functions":"gather","timestamp_sec":3085},{"timestamp_with_hours":"0:52:05","description":"Using fct_recode to fix a typo in a categorical variable","functions":"fct_recode","timestamp_sec":3125},{"timestamp_with_hours":"0:56:00","description":"Copy-pasting previous forecasting code to cheese and reviewing any changes needed","timestamp_sec":3360},{"timestamp_with_hours":"0:57:20","description":"Discussing alternative approach: creating interactive visualisation using shiny package to do direct comparisons","packages":"shiny","timestamp_sec":3440}]</script>
