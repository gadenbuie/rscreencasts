---
title: |
  Ramen Reviews
description: |
  Web scraping (rvest package)
date: 2019-06-03
date-format: long
---

Notable topics: Web scraping (rvest package)

Recorded on: 2019-06-03

Timestamps by: Alex Cookson

[View code](https://github.com/dgrtwo/data-screencasts/blob/master/ramen-ratings.Rmd)

## Full screencast

<iframe class="video" src="https://www.youtube.com/embed/tCa2di7aEP4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Timestamps

<script id="timestamps" type="application-json">[{"timestamp_with_hours":"0:1:45","description":"Looking at the website the data came from","timestamp_sec":105},{"timestamp_with_hours":"0:2:55","description":"Using gather function (now pivot_longer) to convert wide data to long (tidy) format","functions":"gather","timestamp_sec":175},{"timestamp_with_hours":"0:4:15","description":"Graphing counts of all categorical variables at once, then exploring them","timestamp_sec":255},{"timestamp_with_hours":"0:5:35","description":"Using fct_lump function to lump three categorical variables to the top N categories and \"Other\"","functions":"fct_lump","timestamp_sec":335},{"timestamp_with_hours":"0:7:45","description":"Using reorder_within function to re-order factors that have the same name across multiple facets","functions":"reorder_within","timestamp_sec":465},{"timestamp_with_hours":"0:9:10","description":"Using lm function (linear model) to predict star rating","functions":"lm","timestamp_sec":550},{"timestamp_with_hours":"0:9:50","description":"Visualising effects (and 95% CI) of indendent variables in linear model with a coefficient plot (TIE fighter plot)","timestamp_sec":590},{"timestamp_with_hours":"0:11:30","description":"Using fct_relevel function to get \"Other\" as the base reference level for categorical independent variables in a linear model","functions":"fct_relevel","timestamp_sec":690},{"timestamp_with_hours":"0:13:05","description":"Using extract function and regex to split a camelCase variable into two separate variables","functions":"extract","timestamp_sec":785},{"timestamp_with_hours":"0:14:45","description":"Using facet_wrap function to split coefficient / TIE fighter plot into three separate plots, based on type of coefficient","functions":"facet_wrap","timestamp_sec":885},{"timestamp_with_hours":"0:15:40","description":"Using geom_vline function to add reference line to graph","functions":"geom_vline","timestamp_sec":940},{"timestamp_with_hours":"0:17:20","description":"Using unnest_tokens function from tidytext package to explore the relationship between variety (a sparse categorical variable) and star rating","functions":"unnest_tokens","packages":"tidytext","timestamp_sec":1040},{"timestamp_with_hours":"0:18:55","description":"Explanation of how he would approach variety variable with Lasso regression","timestamp_sec":1135},{"timestamp_with_hours":"0:19:35","description":"Web scraping the using rvest package and SelectorGadget (Chrome Extension CSS selector)","packages":"rvest","timestamp_sec":1175},{"timestamp_with_hours":"0:21:20","description":"Actually writing code for web scraping, using read_html, html_node, and html_table functions","functions":"read_html | html_node | html_table","packages":"rvest","timestamp_sec":1280},{"timestamp_with_hours":"0:22:25","description":"Using clean_names function from janitor package to clean up names of variables","functions":"clean_names","packages":"janitor","timestamp_sec":1345},{"timestamp_with_hours":"0:23:05","description":"Explanation of web scraping task: get full review text using the links from the review summary table scraped above","timestamp_sec":1385},{"timestamp_with_hours":"0:25:40","description":"Using parse_number function as alternative to as.integer function to cleverly drop extra weird text in review number","functions":"parse_number","timestamp_sec":1540},{"timestamp_with_hours":"0:26:45","description":"Using SelectorGadget (Chrome Extension CSS selector) to identify part of page that contains review text","timestamp_sec":1605},{"timestamp_with_hours":"0:27:35","description":"Using html_nodes, html_text, and str_subset functions to write custom function to scrape review text identified in step above","functions":"html_nodes | html_text | str_subset","packages":"rvest","timestamp_sec":1655},{"timestamp_with_hours":"0:29:15","description":"Adding message function to custom scraping function to display URLs as they are being scraped","functions":"message","timestamp_sec":1755},{"timestamp_with_hours":"0:30:15","description":"Using unnest_tokens and anti_join functions to split review text into individual words and remove stop words (e.g., \"the\", \"or\", \"and\")","functions":"unnest_tokens | anti_join","timestamp_sec":1815},{"timestamp_with_hours":"0:31:05","description":"Catching a mistake in the custom function causing it to read the same URL every time","timestamp_sec":1865},{"timestamp_with_hours":"0:31:55","description":"Using str_detect function to filter out review paragraphs without a keyword in it","functions":"str_detect","timestamp_sec":1915},{"timestamp_with_hours":"0:32:40","description":"Using str_remove function and regex to get rid of string that follows a specific pattern","functions":"str_remove","timestamp_sec":1960},{"timestamp_with_hours":"0:34:10","description":"Explanation of possibly and safely functions in purrr package","functions":"possibly | safely","packages":"purrr","timestamp_sec":2050},{"timestamp_with_hours":"0:37:45","description":"Reviewing output of the URL that failed to scrape, including using character(0) as a default null value","timestamp_sec":2265},{"timestamp_with_hours":"0:48:00","description":"Using pairwise_cor function from widyr package to see which words tend to appear in reviews together","functions":"pairwise_cor","packages":"widyr","timestamp_sec":2880},{"timestamp_with_hours":"0:51:05","description":"Using igraph and ggraph packages to make network plot of word correlations","packages":"igraph | ggraph","timestamp_sec":3065},{"timestamp_with_hours":"0:51:55","description":"Using geom_node_text function to add labels to network plot","functions":"geom_node_text","packages":"igraph | ggraph","timestamp_sec":3115},{"timestamp_with_hours":"0:52:35","description":"Including all words (not just those connected to others) as vertices in the network plot","packages":"igraph | ggraph","timestamp_sec":3155},{"timestamp_with_hours":"0:54:40","description":"Tweaking and refining network plot aesthetics (vertex size and colour)","timestamp_sec":3280},{"timestamp_with_hours":"0:56:00","description":"Weird hack for getting a dark outline on hard-to-see vertex points","timestamp_sec":3360},{"timestamp_with_hours":"0:59:15","description":"Summary of screencast","timestamp_sec":3555}]</script>
